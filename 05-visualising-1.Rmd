# Visualising spatial data part 1: tmap and mapview {#visualising1}

## Overall goal of the chapter
In the previous section we explored different types of spatial data and looked at how these can be used to create a map. In this section we will use `tmap` and `mapview` packages to crate both static and interactive maps. In particular, we will focus on the goals presented below.

<style>
div.green { background-color:#e3ffd9; border-radius: 5px; padding: 20px;}
</style>
<div class = "green">
### Learning objectives {-}

- Create static and interactive maps using different packages
- Learn function structure to build more advanced maps
- Analyse the differences between used packages and identify their applicability for various purposes

</div>


This chapter requires the following packages (some of them we used already):

```{r, eval=FALSE}
cran_packages_to_install <- c(
  "mapview",            # map-making package for interactive maps
  "tmap",               # map-making package for static and interactive maps
  "tidyverse",         # metapackage containing dplyr, ggplot2 and other packages
  "sf",                # package for working with spatial data
  "rnaturalearth",     # data package
  "rnaturalearthdata"  # data package
  )
install.packages(cran_packages_to_install)
```

Next, we need to load the packages:

```{r, results='hide', warning=FALSE, message=FALSE}
library(tmap)
library(mapview)
library(ggplot2)
library(sf)
library(afrilearndata)
library(rnaturalearth)
library(rnaturalearthdata)
library(dplyr)
```

## Quick interactive maps with mapview
`Mapview package` allows quickly and easily create interactive maps of spatial data. Therefore, it is useful when we want to quickly explore the data visually without excessive care about the quality of the presentation. However, if we need static maps or interactive maps which are more elaborate we might want to consider other options such as `tmap package` which will be presented later in this chapter.<br/>

The typical spatial objects types supported by `mapview` package are: 

- sf
- raster
- sp


```{r, warning=FALSE, message=FALSE}
# data(africountries)
# mapview(africountries)
```

## Static maps with tmap
In this section we will explore the possibilities of `tmap` in creating static maps, which is a flexible, yet user-friendly package. Its syntax is similar to `ggplot2` (plot-making package), where additional features of the map are simply build up on top of the basic structure. It will be demonstrated below, where we will start off with a simple contour map.

Create a dataset:
```{r}
africa <- ne_countries(continent = 'africa', scale = "medium", returnclass = "sf")
```
Create an empty contour map of the continent, where `tm_shape()` function contains shape object (our spatial dataset) and `tm_borders()` defines the borders of the polygons. 
```{r}
# tm_shape(africa)+
#  tm_borders()
```
We can further develop our map by adjusting the colour, width, types and transparency of the border lines. The extra parameters for changing the plot elements can be found [here](http://publish.illinois.edu/johnrgallagher/files/2015/10/BaseGraphicsCheatsheet.pdf).
```{r}
# tmap_mode("plot")
# tm_shape(africa)+
#  tm_borders(col = "green", lwd = 1.5, lty = "dotted", alpha = 0.6)
```
- Exercise 1: change the settings to the map to obtain blue, solid and non-transparent borders such as showed below: 

```{r, echo=FALSE}
# tm_shape(africa)+
#  tm_borders(col = "blue", lwd = 1.5, lty = "solid", alpha = 1)
```


### Layers for the static maps

Fill map using data on last census data and add labels for country names

```{r, warning=FALSE}
# tm_shape(africa)+
#  tm_fill(col="lastcensus", title="Year of last census", legend.format = list(format="s"))+
#  tm_borders()+
#  tm_text("admin", size = 0.52,  fontface="bold", auto.placement = TRUE)

```

### Colour pallet


## Interactive maps with tmap

`tmap` offers versatility not only for creating static maps as we have seen above but it also allows us to make customised interactive maps conveniently by simply changing the mode of operation from static *plot* to dynamic *view* using `tmap_mode()`

```{r, warning=FALSE}
# tmap_mode("view") #switches to interactive mode
# tm_shape(africa)+  #creates a map from previous chapter in an interactive mode
#   tm_borders()

```


## Further resources

## Exercise solutions

- Exercise 1
```{r, results='hide'}
tm_shape(africa)+
 tm_borders(col = "blue", lwd = 1.5, lty = "solid", alpha = 1)
```
